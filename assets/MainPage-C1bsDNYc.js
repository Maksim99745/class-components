import{r as l,j as t}from"./react-BWtM72Fx.js";import{u as $,a as _}from"./react-redux-DGd5iOsm.js";import{u as C,L as D}from"./react-router-dom-CyljvOGg.js";import{a as A,b as T,u as L,c as F,d as I,e as R,L as O}from"./index-DCd1bek6.js";import{f as U}from"./redux-E-Rf1aW7.js";import{c as B,b as q,O as V}from"./react-router-C_NjS6MD.js";import"./use-sync-external-store-DVoJ7RR5.js";import"./react-dom-BGFKlzYW.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-DGxTVJB8.js";import"./@reduxjs-BripY6zo.js";import"./immer-66utYGpe.js";import"./reselect-DUoTfIGH.js";import"./redux-thunk-ClJT1hhx.js";const M={...A,...T},x=()=>{const e=$();return l.useMemo(()=>U(M,e),[e])},Q="_character-box_1o5tw_1",G="_character-name_1o5tw_13",H="_favorite_1o5tw_18",g={"character-box":"_character-box_1o5tw_1",characterBox:Q,"character-name":"_character-name_1o5tw_13",characterName:G,favorite:H};function K({character:e}){const[s]=C(),n=s.get("page")||1,a=_(c=>c.favorites),{toggleFavorite:r}=x();return t.jsxs("div",{className:g.characterBox,children:[t.jsx(D,{to:{pathname:`/details/${e.name}`,search:`page=${n}`},children:t.jsxs("div",{className:g.characterName,children:["Name: ",e.name]})}),t.jsx("div",{children:t.jsxs("label",{htmlFor:e.name,className:g.favorite,children:[t.jsx("input",{type:"checkbox",id:e.name,style:{cursor:"pointer"},name:"favorite",checked:a.includes(e),onChange:()=>r(e)}),"Favorite"]})})]})}const W="_items-block_1p08u_1",z={"items-block":"_items-block_1p08u_1",itemsBlock:W};function J(){var s,n,a;const e=_(r=>r.characters);return e?t.jsxs("div",{className:z.itemsBlock,children:[(n=(s=e[0])==null?void 0:s.results)==null?void 0:n.map(r=>t.jsx("div",{children:t.jsx(K,{character:r})},r.name)),((a=e[0])==null?void 0:a.count)===0&&t.jsx("div",{children:"Characters data not found"})]}):t.jsx("div",{children:"Characters data not found"})}const X="_main-page_r0y9r_1",Y="_name-container_r0y9r_10",Z="_results-block_r0y9r_18",tt="_error-button_r0y9r_23",et="_item-details_r0y9r_31",m={"main-page":"_main-page_r0y9r_1",mainPage:X,"name-container":"_name-container_r0y9r_10",nameContainer:Y,"results-block":"_results-block_r0y9r_18",resultsBlock:Z,"error-button":"_error-button_r0y9r_23",errorButton:tt,"item-details":"_item-details_r0y9r_31",itemDetails:et};function nt(){const[e,s]=l.useState(!1),n=()=>{s(!0)};if(e)throw new Error("This is the test error for checking Error Boundary");return t.jsx("button",{type:"button",className:m.errorButton,onClick:n,children:"Error button"})}const st="_favorites-toolbar_11ni2_1",at="_favorites-amount_11ni2_12",rt="_buttons-block_11ni2_18",v={"favorites-toolbar":"_favorites-toolbar_11ni2_1",favoritesToolbar:st,"favorites-amount":"_favorites-amount_11ni2_12",favoritesAmount:at,"buttons-block":"_buttons-block_11ni2_18",buttonsBlock:rt},ot=e=>{if(e.length===0)return"";function s(r){return r in e[0]}const n=Object.keys(e[0]).filter(s);return[n.join(","),...e.map(r=>n.map(c=>{const o=r[c];return Array.isArray(o)?`"${o.join(",")}"`:`"${`${o}`.replace(/"/g,'""')}"`}).join(","))].join(`
`)};function ct(){const e=_(a=>a.favorites),{unselectAll:s}=x(),n=()=>{const a=ot(e),r=new Blob([a],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(r),o=document.createElement("a");o.href=c;const i=`${e.length}_favorites.csv`;o.download=i,o.click(),URL.revokeObjectURL(c)};return t.jsxs("div",{className:v.favoritesToolbar,children:[t.jsxs("p",{className:v.favoritesAmount,children:["Favorites amount: ",e.length]}),t.jsxs("div",{className:v.buttonsBlock,children:[t.jsx("button",{type:"button",onClick:()=>s(),children:"Unselect all"}),t.jsx("button",{type:"button",onClick:()=>n(),children:"Download"})]})]})}const it="_pagination-container_jqwyl_1",lt="_current-page_jqwyl_6",ut={"pagination-container":"_pagination-container_jqwyl_1",paginationContainer:it,"current-page":"_current-page_jqwyl_6",currentPage:lt},ht=10,y=e=>Math.ceil(e/ht);function mt({toPrevPage:e,toNextPage:s,currentPage:n}){var i,u,h;const a=_(f=>f.characters),r=n===y(((i=a[0])==null?void 0:i.count)??1),c=n===1,o=y(((u=a[0])==null?void 0:u.count)??1);return((h=a[0])==null?void 0:h.count)<=1?null:t.jsxs("div",{className:ut.paginationContainer,children:[t.jsx("button",{type:"button",disabled:c,onClick:e,children:"<"}),t.jsx("div",{children:`${n||"1"} / ${o}`}),t.jsx("button",{type:"button",disabled:r,onClick:s,children:">"})]})}const _t="";function N(e){const[s,n]=l.useState(()=>localStorage.getItem(e)??_t);return l.useEffect(()=>{localStorage.setItem(e,s)},[e,s]),[s,n]}const dt="_search-input-container_1cfnx_1",pt="_search-input_1cfnx_1",k={"search-input-container":"_search-input-container_1cfnx_1",searchInputContainer:dt,"search-input":"_search-input_1cfnx_1",searchInput:pt};function ft({updateQuery:e,isBusy:s}){const[n,a]=N("class-component"),r=B(),c=i=>{a(i.target.value)},o=async i=>{i.preventDefault(),r(`/?search=${n}`),e(n)};return t.jsx("form",{onSubmit:o,children:t.jsxs("div",{className:k.searchInputContainer,children:[t.jsx("input",{value:n||"",placeholder:"Enter your search query...",onChange:c,type:"search",className:k.searchInput}),t.jsx("button",{type:"submit",disabled:s,children:"Search"})]})})}function gt(){const e=L(),s=F();return t.jsxs("label",{htmlFor:"themeButton",children:[t.jsx("input",{type:"checkbox",id:"themeButton",style:{cursor:"pointer"},name:"themeButton",checked:e,onChange:()=>s()}),"Dark theme"]})}function Dt(){const[e,s]=C({page:"1"}),n=Number(e.get("page")),[a,r]=N("class-component"),c=_(p=>p.favorites),o=q(),i=B(),{updateCharacters:u}=x(),{data:h,isFetching:f}=I(a),{data:b,isFetching:S}=R(String(n)),d=f||S;l.useEffect(()=>{u(h)},[h]),l.useEffect(()=>{u(b)},[b]);const P=p=>{r(p)},E=()=>{s({page:String(n-1)})},w=()=>{s({page:String(n+1)})},j=()=>{o.pathname.includes("details")&&i(`/?page=${n}`)};return t.jsxs("div",{className:m.mainPage,children:[t.jsx(gt,{}),t.jsxs("div",{className:m.nameContainer,children:[t.jsx("h3",{children:"Find your favorite The Star Wars character!"}),t.jsx(nt,{})]}),t.jsx("div",{onClick:()=>j(),role:"presentation",children:t.jsx(ft,{updateQuery:P,isBusy:d})}),t.jsxs("div",{className:m.resultsBlock,role:"presentation",children:[!d&&t.jsx("div",{className:m.resultsBlock,role:"presentation",children:t.jsx(J,{})}),t.jsx(V,{})]}),!d&&t.jsx("span",{onClick:()=>j(),role:"presentation",children:t.jsx(mt,{currentPage:n,toPrevPage:E,toNextPage:w})}),d&&t.jsx(O,{}),c.length!==0&&t.jsx(ct,{})]})}export{Dt as default};
